<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>The Prescription</title>
  </head>
  <body>
    <main>
      <h1>The Prescription</h1>
      <section>
        <h2>Prescription Details</h2>
        <label>
          Price per refill
          <input type="number" name="price" id="price" />
        </label>
        <label>
          Number of refills
          <input type="number" name="refills" id="refills" />
        </label>
        <label>
          Subscribed?
          <input type="checkbox" name="subscribed" id="subscribed" />
        </label>
        <label>
          Coupon?
          <input type="checkbox" name="coupon" id="coupon" />
        </label>
        <button id="calculate">Calculate Cost</button>
      </section>
      <label>
        Total Cost
        <output id="cost">$0.00</output>
      </label>
    </main>

    <script src="index.js"></script>
    <script>
      const { getTotalCost, applyDiscount, applyCoupon } = require('./index');

      const calculateButton = document.querySelector("#calculate");

      calculateButton.addEventListener("click", () => {
        const pricePerRefill = parseFloat(document.querySelector("#price").value);
        const refills = parseInt(document.querySelector("#refills").value, 10);
        const isSubscribed = document.querySelector("#subscribed").checked;
        const hasCoupon = document.querySelector("#coupon").checked;

        // Check if values are valid
        if (isNaN(pricePerRefill) || isNaN(refills)) {
          alert("Please enter valid values for price and refills.");
          return;
        }

        // Calculate the initial cost without any discounts.
        const initialCost = getTotalCost(pricePerRefill, refills);

        // Apply the subscription discount.
        const costAfterSubscription = applyDiscount(initialCost, isSubscribed);

        // Apply the coupon discount.
        const finalCost = applyCoupon(costAfterSubscription, hasCoupon);

        // Display the final cost on the page.
        document.querySelector("#cost").textContent = `$${finalCost.toFixed(2)}`;
      });
    </script>
  </body>
</html>
